<html>

<head>
    <meta charset="utf-8">
    <title>Andromeda v1.0</title>
    <link rel="stylesheet" href="bootstrap-4.0.0-alpha.5-dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="images/favicon.png">
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.7/js/tether.min.js"></script>
    <script src="bootstrap-4.0.0-alpha.5-dist/js/bootstrap.min.js"></script>
    
    <script>
        $('a').click(function () {
            $('html, body').animate({
                scrollTop: $($(this).attr('href')).offset().top
            }, 300);
            return false;
        });
    </script>

    <!-- google analytics -->
   <!-- <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-89158232-1', 'auto');
        ga('send', 'pageview');
    </script>-->
</head>

<body>
    <div class="container main">
        <div class="row">
            <a href="index.html" style="color: white">RU</a><label style="color: white"> |</label>
            <a href="indexen.html" style="color: white">EN</a>
        </div>
        <div class="row main">
            <div class="vert">
                <div class="card wrap fh bgmain">
                    <div class="card-block header text-xs-center ">
                        <h1 class="title"><a class="nodecor" >ANDROMEDA 1.0</a></h1>
                        <!--<h5 class="card-subtitle text-muted">
                            Easy Java GUI library for <a class="card-link" href="https://www.lwjgl.org/">LWJGL 3</a> users
                        </h5>-->
                    </div>
                </div>
            </div>
        </div>
        <div class="row main section examples" style="padding: 0% 3% 0% 3%">
            <div id="examples" class="anchor"></div>
            <br>
            <h2 style="text-align: center;">Описание шифра Andromeda</h2>
            <br>
            <p style="margin: 0% 5% 0% 5%">
                <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Шифр Андромеда – это поточный шифр с высокой степенью стойкости практически к любым видам атак, за счет колоссального выхода генератора ключа <i>((256<sup>2</sup>)<sup>256^1500+256^1500</sup>)</i>. Наиболее эффективная атака на этот шифр (как и на любой другой) это перебор ключа методом грубой силы, но за счет некоторых особенностей, о которых будет сказано ниже, эффективность брутфорса для этого шифра крайне низка. Без пароля подобрать ключ за вменяемое время нельзя. Алгоритм также «прощает» использование простых паролей, выход генератора за счет широкополосного блока прогрева никак не дает понять, что использована простая входная последовательность бит. При подборе пароль более реально просто угадать, если пароль «123» например, чем перебрать все возможные значения ключа. Шифр построен по схеме сходной с одноразовым блокнотом  в основу положена архитектура sponge, состоит шифр из независимых блоков по принципу криптопримитивов, что дает возможность, комбинируя блоки шифра, собирать сколь угодно сложные схемы для шифрования информации. По факту это шифр является гибридным (блочно-поточным), но авторами он позиционируется как поточный. Andromeda легко реализует любые режимы шифрования от CBC до OFB в любых вариациях. Этот шифр прост в реализации, как в программном так и аппаратном обеспечении. Впервые этот шифр был представлен в 2012 году на сайте компании oriondevteam.com, которая является авторам нашумевшего в то время программного обеспечения orion cipher box с алгоритмом комплексной криптографической защиты orion 7b. Есть информация, что шифр был выставлен на конкурс NIST, после чего им заинтересовались спецслужбы США, в следствии этого шифр был снят с конкурса, также компания-разработчик данного алгоритма куда-то внезапно пропала, после описанных выше событий.</p>
                <p>В базовой реализации обычно состоит из пяти блоков:</p>
            <ol>
                <li>блок инициализации;</li>
                <li>блок шифрования;</li>
                <li>блок прогрева;</li>
                <li>блок перестановки;</li>
                <li>блок деинициализации.</li>
                </ol>
                <p>Центральным узлом любого поточного шифра является генератор ключевого расписания,  и Andromeda не исключение.</p>
                <p>По своей схеме работы генератор ключа Andromeda напоминает генератор ключа в RC4, за исключением того, что Andromeda использует два блока ключа, каждый по 12 000 бит, хотя на сайте авторов была описана реализация генератора, в котором эти блоки имеют размер аж по 120 000 бит каждый. Еще одно отличие генератора ключевого расписания от каноничного генератора RC4 в том, что блоки заполняются при помощи алгоритмов хеширования в режиме PBKDFx, x~8000 с использованием функций-преобразователей (хеш-функции).</p>
                <p>Хешировать входной пароль для получения ключа возможно в любой комбинации, но автор шифра рекомендует именно режим PBKDFx, x~8000, причем каждый из массивов генератора, которые называются Pool и S-Box рекомендуется заполнять так:</p>
                <p><b><i>Например</i></b> у нас есть <i>пароль 123</i>, S-Box мы заполняем <i>результирующим выходом от хеш-функции Whirlpool PBKDFx, x~8000 (123) – выход 1500 байт</i>, после чего <i>пароль реверсируется 123</i> => 321 и массив Pool заполняется так, <i>SHA512 PBKDFx, x~8000 (321) – выход 1500 байт</i>. Как и сказано выше, это <i>рекомендуемые параметры</i>, выполнять преобразование пароля для инициализации структур генератора можно сколь угодно сложным образом, разумеется можно менять используемые алгоритмы. Самое главное правило – <b>функция хеширования должна быть <i>криптографически стойкой</i>, а результат ее работы в любом из режимов должен <i>отвечать правилу для ГПСЧ</i> – правило 1567.</b></p>
                <p>Следующая особенность Andromeda в том, что <b>шифр имеет байтовый весовой шифратор</b>, принцип его работы, а также псевдокод мы рассмотрим ниже.</p>

                <p>Теперь рассмотрим каждый блок шифра в отдельности.</p>
                <p><b>Блок инициализации</b></p>
                <p>Блок инициализации нужен для того, чтобы выполнить описанные выше действия над массивами ГПСЧ алгоритма, его работа отражена выше.</p>
                <p><b>Блок шифрования</b></p>
                <p>Одной из особенностей блока шифрования алгоритма является:</p>
            <ol>
                <li>Использование трех ключевых байт для изменения одного открытого байта информации</li>
                <li>Механизм шифрования, который в зависимости от значения двух ключей (один из Pool другой из SBox) выполняет либо один набор действий для шифрования открытых данных, либо другой.</li>
                </ol>
                <p>Блок криптографического преобразования можно также изменять и реализовывать как угодно. Есть два варианта от авторов, в первом варианте криптографическое преобразование достигается за счет умножения открытого текста на ключ по-модулю, алгоритм Radix-Z</p>
                <p><b>Байтовый ширатор\дешифратор (псевдокод).</b></p>
            <div style="text-align: center;">
                <img src="images/code_1.jpg" style="max-width:80%;">
            </div>

                <p><b>Блок прогрева</b></p>
                <p>Этот блок представляет собой работу генератора в холостом режиме, в режиме счетчика, т.е. выполняется процедура шифрования нулевого байта заданным паролем, в результате чего начальное состояние массивов генератора изменяется, после чего можно приступать к шифрованию основных данных. Это нужно для того, чтобы исключить даже минимальную корреляцию элементов ключевого расписания. Напомним, что Корреля́ция (от лат. correlatio «соотношение, взаимосвязь») или корреляционная зависимость — статистическая взаимосвязь двух или более случайных величин (либо величин, которые можно с некоторой допустимой степенью точности считать таковыми).</p>
                <p><b>Блок перестановки</b></p>
                <p>блок, в котором происходит перестановка элементов массивов Pool и SBox для определения ключей.</p>

                <p>Псевдокод реализации блока перестановки с шифратором приведен ниже:</p>
            <div style="text-align: center;">
                <img src="images/code_2.jpg" style=" max-width:100%;">
                </div>

                Схема работы блока перестановки:

            </p>
            <div style="text-align: center;">
                <img style="border: 1px solid gray; max-width:100%;" src="images/ris1.png">
            </div>
            <p style="margin: 0% 5% 0% 5%">
                <p><b>Блок деинициализации</b></p>
                <p>Блок очищение инициализированных генератором структур в памяти компьютера методом Гутмана, что означает удаление многократным перезаписываниемячеек памяти по адресам. Применение алгоритма – гутман или DoD не критично, в аппаратной реализации данный блок работает немного по-другому, он просто зануляет ячейки временной памяти в плате</p>
            </p>
            <br/>
        </div>
        <div class="hr"></div>
    </div>
    
    <div id="foo" class="footer"></div>
    <script type="text/javascript"> $('#foo').load("template/footer.html");</script>
</body>

</html>